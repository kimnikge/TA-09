<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–µ–º—ã –ë–î</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .table-info { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .exists { background-color: #d4edda; border-color: #c3e6cb; }
        .not-exists { background-color: #f8d7da; border-color: #f5c6cb; }
        .error { background-color: #fff3cd; border-color: #ffeaa7; }
        .columns { margin-top: 10px; }
        .column { display: inline-block; background: #007bff; color: white; padding: 2px 8px; margin: 2px; border-radius: 3px; font-size: 12px; }
        .loading { text-align: center; padding: 50px; }
    </style>
</head>
<body>
    <h1>üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Supabase</h1>
    
    <div id="loading" class="loading">
        <p>‚è≥ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∞–±–ª–∏—Ü—ã...</p>
    </div>
    
    <div id="results" style="display: none;"></div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Supabase
        const supabaseUrl = 'https://olutrxiazrmanrgzzwmb.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9sdXRyeGlhenJtYW5yZ3p6d21iIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA4NzMwMjEsImV4cCI6MjA2NjQ0OTAyMX0.qxU_1Fjk4Mu9vMSfEI4jSGm3yYhh9WbmlSEFttOMKiM';
        
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
        
        async function checkAllTables() {
            const loadingDiv = document.getElementById('loading');
            const resultsDiv = document.getElementById('results');
            
            // –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
            const tablesToCheck = [
                'clients', 
                'products', 
                'orders',
                'users',
                'categories',
                'inventory',
                'sales',
                'order_items',
                'cart',
                'cart_items'
            ];
            
            let html = '<h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:</h2>';
            
            for (const tableName of tablesToCheck) {
                try {
                    const { data, error } = await supabase
                        .from(tableName)
                        .select('*')
                        .limit(1);
                    
                    if (error) {
                        if (error.message.includes('does not exist')) {
                            html += `
                                <div class="table-info not-exists">
                                    <h3>‚ùå ${tableName}</h3>
                                    <p>–¢–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç</p>
                                </div>
                            `;
                        } else {
                            html += `
                                <div class="table-info error">
                                    <h3>‚ö†Ô∏è ${tableName}</h3>
                                    <p>–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞: ${error.message}</p>
                                </div>
                            `;
                        }
                    } else {
                        const columns = data && data.length > 0 ? Object.keys(data[0]) : [];
                        const isEmpty = !data || data.length === 0;
                        
                        html += `
                            <div class="table-info exists">
                                <h3>‚úÖ ${tableName}</h3>
                                <p>–°—Ç–∞—Ç—É—Å: ${isEmpty ? '–¢–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞' : `–ó–∞–ø–∏—Å–µ–π: ${data.length}+`}</p>
                                ${columns.length > 0 ? `
                                    <div class="columns">
                                        <strong>–ö–æ–ª–æ–Ω–∫–∏:</strong><br>
                                        ${columns.map(col => `<span class="column">${col}</span>`).join('')}
                                    </div>
                                ` : '<p>–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É (—Ç–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞)</p>'}
                                ${data && data.length > 0 ? `
                                    <details style="margin-top: 10px;">
                                        <summary>–ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö</summary>
                                        <pre style="background: #f8f9fa; padding: 10px; border-radius: 3px; overflow: auto;">${JSON.stringify(data[0], null, 2)}</pre>
                                    </details>
                                ` : ''}
                            </div>
                        `;
                    }
                } catch (error) {
                    html += `
                        <div class="table-info error">
                            <h3>üí• ${tableName}</h3>
                            <p>–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ${error.message}</p>
                        </div>
                    `;
                }
            }
            
            loadingDiv.style.display = 'none';
            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = html;
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        checkAllTables();
    </script>
</body>
</html>
